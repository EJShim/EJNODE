{"version":3,"file":"func_generator.js","sourceRoot":"","sources":["func_generator.ts"],"names":[],"mappings":"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","sourcesContent":["// (c) 2016 Machine Intelligence Laboratory (The University of Tokyo), MIT License.\r\nimport Matrix = require('./matrix');\r\nimport util = require('./util');\r\n\r\nexport type MatrixOrNumber = util.MatrixOrNumber;\r\nexport function make_compare_func_all(operation: string): (A: MatrixOrNumber, B: MatrixOrNumber) => Matrix {\r\n  var func_s_s = make_binary_arith_func(operation, false, false, 'logical');\r\n  var func_s_m = make_binary_arith_func(operation, false, true, 'logical');\r\n  var func_m_s = make_binary_arith_func(operation, true, false, 'logical');\r\n  var func_m_m = make_binary_arith_func(operation, true, true, 'logical');\r\n  return function(A: MatrixOrNumber, B: MatrixOrNumber) {\r\n    A = util.force_cpu_scalar(A);\r\n    B = util.force_cpu_scalar(B);\r\n    if (A instanceof Matrix) {\r\n      if (B instanceof Matrix) {\r\n        return func_m_m(A, B);\r\n      } else {\r\n        return func_m_s(A, B);\r\n      }\r\n    } else {\r\n      if (B instanceof Matrix) {\r\n        return func_s_m(A, B);\r\n      } else {\r\n        return func_s_s(A, B);\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport function make_binary_arith_func(operation: string, a_mat: boolean, b_mat: boolean, dst_klass: string): (A: MatrixOrNumber, B: MatrixOrNumber) => Matrix {\r\n  var l_shape;\r\n  var l_size_check = '';\r\n  var l_def_adata = '';\r\n  var l_def_bdata = '';\r\n  var l_get_a;\r\n  var l_get_b;\r\n  if (a_mat) {\r\n    l_shape = 'A._size';\r\n    l_def_adata = 'var a_data = A._data;';\r\n    l_get_a = 'a_data[i]';\r\n    if (b_mat) {\r\n      l_size_check = 'if (!e_util.jsaequal(A._size, B._size)) {throw new Error(\"Dimension mismatch\");}';\r\n    }\r\n  } else {\r\n    l_get_a = 'A';\r\n    if (b_mat) {\r\n      l_shape = 'B._size';\r\n    } else {\r\n      l_shape = '[1,1]';\r\n    }\r\n  }\r\n\r\n  if (b_mat) {\r\n    l_def_bdata = 'var b_data = B._data;';\r\n    l_get_b = 'b_data[i]';\r\n  } else {\r\n    l_get_b = 'B';\r\n  }\r\n\r\n  var l_opr_formatted = operation.replace('%a', l_get_a).replace('%b', l_get_b);\r\n\r\n  var f: any;\r\n  var e_Matrix = Matrix;\r\n  var e_util = util;\r\n\r\n  eval([\r\n    'f = function(A, B) {',\r\n    'var shape = ' + l_shape + ';',\r\n    l_size_check,\r\n    l_def_adata,\r\n    l_def_bdata,\r\n    'var dst = new e_Matrix(shape, \"' + dst_klass + '\");',\r\n    'var dst_data = dst._data;',\r\n    'for (var i = 0, length = dst._numel; i < length; i++) {',\r\n    '  dst_data[i] = ' + l_opr_formatted + ';',\r\n    '}',\r\n    'return dst;',\r\n    '}'\r\n  ].join('\\n'));\r\n  return f;\r\n}\r\n\r\nexport function make_binary_arith_func_all(operation: string): (A: MatrixOrNumber, B: MatrixOrNumber) => Matrix {\r\n  var funcs = {};\r\n  return function(A: MatrixOrNumber, B: MatrixOrNumber) {\r\n    var dst_klass = util.commonklass(A, B);\r\n    A = util.force_cpu_scalar(A);\r\n    B = util.force_cpu_scalar(B);\r\n    if (dst_klass == 'logical') {\r\n      dst_klass = 'single';\r\n    }\r\n    var a_mat = A instanceof Matrix;\r\n    var b_mat = B instanceof Matrix;\r\n    var func_name = '' + a_mat + '_' + b_mat + '_' + dst_klass;\r\n    var f = funcs[func_name];\r\n    if (!f) {\r\n      // compile (eval) function on first call\r\n      f = make_binary_arith_func(operation, a_mat, b_mat, dst_klass);\r\n      funcs[func_name] = f;\r\n    }\r\n\r\n    return f(A, B);\r\n  }\r\n}\r\n\r\nexport function make_unary_arith_func(operation: string, a_mat: boolean, dst_klass: string): (A: MatrixOrNumber) => Matrix {\r\n  var l_shape: string;\r\n  var l_def_adata = '';\r\n  var l_get_a;\r\n  if (a_mat) {\r\n    l_shape = 'A._size';\r\n    l_def_adata = 'var a_data = A._data;';\r\n    l_get_a = 'a_data[i]';\r\n  } else {\r\n    l_shape = '[1,1]';\r\n    l_get_a = 'A';\r\n  }\r\n\r\n  var l_opr_formatted = operation.replace(/%a/g, l_get_a);\r\n\r\n  var f: any;\r\n  var e_Matrix = Matrix;\r\n  var e_util = util;\r\n\r\n  eval([\r\n    'f = function(A) {',\r\n    'var shape = ' + l_shape + ';',\r\n    l_def_adata,\r\n    'var dst = new e_Matrix(shape, \"' + dst_klass + '\");',\r\n    'var dst_data = dst._data;',\r\n    'for (var i = 0, length = dst._numel; i < length; i++) {',\r\n    '  dst_data[i] = ' + l_opr_formatted + ';',\r\n    '}',\r\n    'return dst;',\r\n    '}'\r\n  ].join('\\n'));\r\n  return f;\r\n}\r\n\r\nexport function make_unary_arith_func_all(operation: string): (A: MatrixOrNumber) => Matrix {\r\n  var funcs = {};\r\n  return function(A: MatrixOrNumber) {\r\n    var dst_klass;\r\n    if (A instanceof Matrix) {\r\n      dst_klass = A._klass;\r\n      if (dst_klass == 'logical') {\r\n        dst_klass = 'single';\r\n      }\r\n    } else {\r\n      dst_klass = 'single';\r\n    }\r\n    A = util.force_cpu_scalar(A);\r\n    var a_mat = A instanceof Matrix;\r\n    var func_name = '' + a_mat + '_' + dst_klass;\r\n    var f = funcs[func_name];\r\n    if (!f) {\r\n      // compile (eval) function on first call\r\n      f = make_unary_arith_func(operation, a_mat, dst_klass);\r\n      funcs[func_name] = f;\r\n    }\r\n\r\n    return f(A);\r\n  }\r\n}\r\n\r\nfunction isequal_two(A: Matrix, B: Matrix): boolean {\r\n  A = A.to_cpu();\r\n  B = B.to_cpu();\r\n  if (!util.issamesize(A._size, B._size)) {\r\n    return false;\r\n  }\r\n\r\n  //(1,1)=>true,(NaN,NaN)=>false,(NaN,1)=>false\r\n  var a_data = A._data;\r\n  var b_data = B._data;\r\n  for (var i = 0, length = a_data.length; i < length; i++) {\r\n    if (a_data[i] !== b_data[i]) {//both are value or include NaN\r\n      // NaN !== NaN\r\n      return false;\r\n    }\r\n  }\r\n\r\n  return true;\r\n}\r\n\r\nexport function isequal(...As: Matrix[]): boolean {\r\n  if (!(As[0] instanceof Matrix)) { return false; }//scalar is not allowed\r\n  for (var i = 1; i < As.length; i++) {\r\n    if (!(As[i] instanceof Matrix)) { return false; }\r\n    if (!isequal_two(As[0], As[i])) {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  return true;\r\n}\r\n\r\nfunction isequaln_two(A: Matrix, B: Matrix): boolean {\r\n  A = A.to_cpu();\r\n  B = B.to_cpu();\r\n  if (!util.issamesize(A._size, B._size)) {\r\n    return false;\r\n  }\r\n\r\n  //(1,1)=>true,(NaN,NaN)=>true,(NaN,1)=>false\r\n  var a_data = A._data;\r\n  var b_data = B._data;\r\n  for (var i = 0, length = a_data.length; i < length; i++) {\r\n    var val_a = a_data[i], val_b = b_data[i];\r\n    if (val_a !== val_b) {\r\n      // NaN !== NaN\r\n      if ((val_a === val_a) || (val_b === val_b)) {//false if both are NaN\r\n        return false;\r\n      }\r\n    }\r\n  }\r\n\r\n  return true;\r\n}\r\n\r\nexport function isequaln(...As: Matrix[]): boolean {\r\n  if (!(As[0] instanceof Matrix)) { return false; }//scalar is not allowed\r\n  for (var i = 1; i < As.length; i++) {\r\n    if (!(As[i] instanceof Matrix)) { return false; }\r\n    if (!isequaln_two(As[0], As[i])) {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  return true;\r\n}\r\n\r\n\r\nfunction make_isclose_func_all(): (A: MatrixOrNumber, B: MatrixOrNumber, rtol?: number, atol?: number, equal_nan?: boolean) => Matrix {\r\n  var func_s_s = make_isclose_func(false, false);\r\n  var func_s_m = make_isclose_func(false, true);\r\n  var func_m_s = make_isclose_func(true, false);\r\n  var func_m_m = make_isclose_func(true, true);\r\n  return function(A: MatrixOrNumber, B: MatrixOrNumber, rtol: number = 1e-5, atol: number = 1e-8, equal_nan: boolean = false) {\r\n    A = util.force_cpu_scalar(A);\r\n    B = util.force_cpu_scalar(B);\r\n    if (A instanceof Matrix) {\r\n      if (B instanceof Matrix) {\r\n        return func_m_m(A, B, rtol, atol, equal_nan);\r\n      } else {\r\n        return func_m_s(A, B, rtol, atol, equal_nan);\r\n      }\r\n    } else {\r\n      if (B instanceof Matrix) {\r\n        return func_s_m(A, B, rtol, atol, equal_nan);\r\n      } else {\r\n        return func_s_s(A, B, rtol, atol, equal_nan);\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport function make_isclose_func(a_mat: boolean, b_mat: boolean): (A: MatrixOrNumber, B: MatrixOrNumber, rtol?: number, atol?: number, equal_nan?: boolean) => Matrix {\r\n  var l_shape;\r\n  var l_size_check = '';\r\n  var l_def_adata = '';\r\n  var l_def_bdata = '';\r\n  var l_get_a;\r\n  var l_get_b;\r\n  if (a_mat) {\r\n    l_shape = 'A._size';\r\n    l_def_adata = 'var a_data = A._data;';\r\n    l_get_a = 'a_data[i]';\r\n    if (b_mat) {\r\n      l_size_check = 'if (!e_util.jsaequal(A._size, B._size)) {throw new Error(\"Dimension mismatch\");}';\r\n    }\r\n  } else {\r\n    l_get_a = 'A';\r\n    if (b_mat) {\r\n      l_shape = 'B._size';\r\n    } else {\r\n      l_shape = '[1,1]';\r\n    }\r\n  }\r\n\r\n  if (b_mat) {\r\n    l_def_bdata = 'var b_data = B._data;';\r\n    l_get_b = 'b_data[i]';\r\n  } else {\r\n    l_get_b = 'B';\r\n  }\r\n\r\n  var f: any;\r\n  var e_Matrix = Matrix;\r\n  var e_util = util;\r\n\r\n  eval([\r\n    'f = function(A, B, rtol, atol, equal_nan) {',\r\n    'var shape = ' + l_shape + ';',\r\n    l_size_check,\r\n    l_def_adata,\r\n    l_def_bdata,\r\n    'var dst = new e_Matrix(shape, \"logical\");',\r\n    'var dst_data = dst._data;',\r\n    'if (equal_nan) {',\r\n    '  for (var i = 0, length = dst._numel; i < length; i++) {',\r\n    '    var val_a = ' + l_get_a + ';',\r\n    '    var val_b = ' + l_get_b + ';',\r\n    '    var absdiff = val_a - val_b;',\r\n    '    if (absdiff < 0) {absdiff = -absdiff}',\r\n    '    var ret = 0;',\r\n    '    if (absdiff <= atol + rtol * ((val_b > 0) ? val_b : -val_b)) {',\r\n    '      ret = 1;',\r\n    '    }',\r\n    '    if ((val_a !== val_a) && (val_b !== val_b)) {',\r\n    '      ret = 1;',\r\n    '    }',\r\n    '    dst_data[i] = ret;',\r\n    '  }',\r\n    '} else {',\r\n    '  for (var i = 0, length = dst._numel; i < length; i++) {',\r\n    '    var val_a = ' + l_get_a + ';',\r\n    '    var val_b = ' + l_get_b + ';',\r\n    '    var absdiff = val_a - val_b;',\r\n    '    if (absdiff < 0) {absdiff = -absdiff}',\r\n    '    var ret = 0;',\r\n    '    if (absdiff <= atol + rtol * ((val_b > 0) ? val_b : -val_b)) {',\r\n    '      ret = 1;',\r\n    '    }',\r\n    '    dst_data[i] = ret;',\r\n    '  }',\r\n    '}',\r\n    'return dst;',\r\n    '}'\r\n  ].join('\\n'));\r\n  return f;\r\n}\r\n\r\nexport var isclose = make_isclose_func_all();\r\n\r\nexport function allclose(A: MatrixOrNumber, B: MatrixOrNumber, rtol?: number, atol?: number, equal_nan?: boolean): boolean {\r\n  var isclose_result = isclose(A, B, rtol, atol, equal_nan);\r\n  var data = isclose_result.getdataref();\r\n  var prod = 1;\r\n  for (var i = 0; i < data.length; i++) {\r\n    prod *= data[i];\r\n  }\r\n\r\n  return prod != 0;\r\n}\r\n"]}